---
title: "Homework 5"
author: "Mohamed Alhassan"
date: "2022-11-14"
output: word_document
---
# Choice 2

## Cleaning the data

```{r}
library(tidyverse)
library(lubridate)
homicides <- read_csv("../data/homicide-data.csv") %>% 
  filter(city == "Baltimore") %>% 
  mutate(reported_date = ymd(reported_date)) %>% 
  separate(col = reported_date, into = c("year", "month", "day"), sep = "-") %>% 
  select(-day) %>%
  unite(col = reported_date, year, month, sep = "-") %>% 
  group_by(reported_date) %>% 
  summarize(total = n()) %>% 
  mutate(reported_date = ym(reported_date))

```

## Creating the Graph

```{r}
library(ggplot2)
library(ggthemes)

gray <- read_csv("../data/homicide-data.csv") %>% 
  filter(uid == "Bal-003523") %>%
  mutate(reported_date = ymd(reported_date)) %>% 
  separate(col = reported_date, into = c("year", "month", "day"), sep = "-") %>% 
  unite(col = reported_date, year, month, sep = "-") %>% 
  mutate(reported_date = ym(reported_date)) %>% 
  select(reported_date) 

  
homicides %>%
  ggplot(aes(x = reported_date, y = total)) +
  geom_col() +
   geom_vline(xintercept = gray$reported_date,
             linetype = 5,
             size = 2,
             color = "red") +
  geom_text(data = filter(.data = homicides$reported_date == 2015-04-01),
            label = "Arrest of Freddie Gray") +
  labs(y = "Monthly homicides", x = "Date", title = "Homicides in Baltimore, MD") +
  theme_dark()

```

